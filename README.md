# DL-PROJECT
本次实验项目使用了LoRA微调的方法对stable diffusion 模型进行了微调，并基于相关的数据集进行了预训练后获得一个预训练的模型。最后再使用预训练后的模型对图像进行修补，和原本未训练的模型进行一系列的比较。

实验中包含两个代码。

第一个代码是通过对示例代码的学习，复现了代码关于LoRA微调的方法，自行调整了代码的评估函数，使得模型的评估函数适用于我们将要使用的数据集。
https://blog.csdn.net/weixin_42426841/article/details/142670977?spm=1001.2014.3001.5506
编译方法：在同一个文件夹内创建一个data文件夹，将dataset中的dog文件夹和prompts文件夹放在data文件中，按顺序编译代码块即可。

第二个代码是我们自己编写的，可以实现图片的修复功能。我们使用下载好的Unet和Text Encoder的参数去替换模型中原有的部分参数，然后将替换后的模型使用于图像修复，取得了一定的效果。
编译方法：需要将文件夹中的两个pth文件与代码放在同一个文件夹当中，直接执行代码块即可。
由于我们只是下载了模型的含有Unet和Text Encoder的参数的JSON文件，所以我们需要将json文件转化为可以使用的合适格式的pth文件，而这一部分的代码块也储存在第二个代码当中。

这个项目所使用到的数据集，包括dataset文件夹以及测试集文件夹在内的文件数据都是我们自行下载、收集、格式转换和标注的。